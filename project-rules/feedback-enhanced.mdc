---
type: "always_apply"
description: "Mecanismo de feedback aprimorado com timeout de 1 hora"
globs: ["**/*"]
alwaysApply: true
enforcement: mandatory
priority: 961

# Gerenciamento de Vers√£o
version: "2.6.0"
last_updated: "2025-10-19"
author: "system"
status: "stable"
compatibility: "rule-system >= 2.0"

changelog:
  - version: "2.6.0"
    date: "2025-10-19"
    changes:
      - "Adi√ß√£o do sistema de gerenciamento de vers√£o"
      - "Padroniza√ß√£o da estrutura do arquivo de regras"
---

# ü§ñ Mecanismo de Feedback Aprimorado

Sistema de feedback inteligente projetado para tarefas de desenvolvimento complexas, suportando intera√ß√£o profunda com timeout de 1 hora.

## üéØ Princ√≠pios Fundamentais

1. **M√©todo de Chamada Unificado** - Usar apenas a ferramenta `mcp_mcp-feedback-enhanced_interactive_feedback`
2. **Mecanismo de Disparo Simplificado** - Condi√ß√µes de disparo claras, evitando complexidade excessiva
3. **Experi√™ncia do Usu√°rio em Primeiro Lugar** - Garantir que a interface de feedback possa ser iniciada e usada normalmente
4. **Itera√ß√£o Cont√≠nua** - Melhoria e otimiza√ß√£o cont√≠nuas baseadas no feedback

## üöÄ Comandos

- `/feedback` - Acionar feedback manualmente
- `/feedback-config` - Configurar defini√ß√µes de feedback
- `/feedback-history` - Ver hist√≥rico de feedback
- `/feedback-summary` - Gerar resumo de trabalho

### Comandos de Disparo por Linguagem Natural
Chamar automaticamente `mcp_mcp-feedback-enhanced_interactive_feedback` quando o usu√°rio usar a seguinte linguagem natural:
- "Chamar programa de feedback"
- "Abrir interface de feedback"
- "Iniciar sistema de feedback"
- "Ativar fun√ß√£o de feedback"

## ‚ú® Funcionalidades

### üïê Timeout Estendido (Extended Timeout)
- **Timeout de 1 hora** - Tempo suficiente para discuss√µes de arquitetura complexas
- **Salvamento Autom√°tico** - Preven√ß√£o de perda de dados durante longas discuss√µes
- **Retomada de Ponto de Interrup√ß√£o** - Suporte para continuar a discuss√£o ap√≥s interrup√ß√£o

### üìù Suporte a Rich Text
- **Snippets de C√≥digo** - Exibi√ß√£o de c√≥digo com destaque de sintaxe
- **Diagramas de Arquitetura** - Suporte a diagramas Mermaid
- **Arquivos de Configura√ß√£o** - Exibi√ß√£o de configura√ß√£o formatada
- **Suporte a Capturas de Tela** - Integra√ß√£o de imagens e capturas de tela

### üîÑ Intera√ß√£o em Tempo Real
- **Comunica√ß√£o Bidirecional** - Di√°logo em tempo real entre AI e usu√°rio
- **Rastreamento de Progresso** - Atualiza√ß√£o de progresso da tarefa em tempo real
- **Registro de Decis√µes** - Registro autom√°tico de decis√µes importantes

## üìã Condi√ß√µes de Disparo

### üîç Regra Especial de Modo Detalhado
Quando o usu√°rio define o modo detalhado, a interface de feedback aprimorado √© chamada automaticamente no in√≠cio de cada sess√£o, garantindo participa√ß√£o e confirma√ß√£o total do usu√°rio em cada etapa do desenvolvimento.

### Cen√°rios de Disparo Autom√°tico

#### üîç Requisitos Pouco Claros
**Condi√ß√£o de Disparo**: Descri√ß√£o do usu√°rio √© vaga ou amb√≠gua
**Exemplo**: "Fa√ßa um site para mim" (falta de requisitos espec√≠ficos)
**Conte√∫do do Feedback**: 
- Tipo e escala do projeto
- Prefer√™ncia de stack tecnol√≥gica
- Lista de requisitos funcionais
- Restri√ß√µes de tempo e or√ßamento

#### üéØ Decis√µes Importantes
**Condi√ß√£o de Disparo**: Decis√µes chave como escolha de arquitetura, sele√ß√£o de stack tecnol√≥gica
**Exemplo**: Escolha entre Microsservi√ßos vs Arquitetura Monol√≠tica
**Conte√∫do do Feedback**:
- Escala do projeto e tamanho da equipe
- Requisitos de desempenho e escalabilidade
- Capacidade e experi√™ncia de opera√ß√µes
- Considera√ß√µes de manuten√ß√£o a longo prazo

#### ‚úÖ Conclus√£o de Projeto
**Condi√ß√£o de Disparo**: Design da solu√ß√£o t√©cnica conclu√≠do, requer confirma√ß√£o do usu√°rio
**Exemplo**: Design de banco de dados conclu√≠do
**Conte√∫do do Feedback**:
- Revis√£o do design da estrutura da tabela
- Confirma√ß√£o da estrat√©gia de √≠ndice
- Avalia√ß√£o de expectativa de desempenho
- Considera√ß√µes de escalabilidade

#### üéâ Execu√ß√£o Conclu√≠da
**Condi√ß√£o de Disparo**: Implementa√ß√£o de c√≥digo conclu√≠da, requer aceita√ß√£o do usu√°rio
**Exemplo**: Desenvolvimento de interface da API conclu√≠do
**Conte√∫do do Feedback**:
- Resultados de testes funcionais
- Atingimento de indicadores de desempenho
- Verifica√ß√£o de seguran√ßa aprovada
- Integridade da documenta√ß√£o

#### üö® Ocorr√™ncia de Erro
**Condi√ß√£o de Disparo**: Encontro de problemas que n√£o podem ser resolvidos automaticamente
**Exemplo**: Conflito de depend√™ncia ou problema de ambiente
**Conte√∫do do Feedback**:
- Informa√ß√µes detalhadas do erro
- Poss√≠veis solu√ß√µes
- A√ß√£o do usu√°rio necess√°ria
- Sugest√£o de solu√ß√£o alternativa

## üñ•Ô∏è Chamada do Programa de Feedback de Desktop MCP

### M√©todo de Chamada Unificado

**√önica maneira correta de chamar**: Usar a ferramenta `mcp_mcp-feedback-enhanced_interactive_feedback`

#### Especifica√ß√£o de Chamada
1. **Nome da Ferramenta**: `mcp_mcp-feedback-enhanced_interactive_feedback`
2. **Par√¢metros Obrigat√≥rios**:
   - `project_directory`: Caminho do workspace atual
   - `summary`: Estado atual e pontos que precisam de confirma√ß√£o do usu√°rio
   - `timeout`: Tempo limite (recomendado 3600 segundos, ou seja, 1 hora)

#### Exemplo de Chamada Padr√£o
```javascript
// Maneira correta de chamar
mcp_mcp-feedback-enhanced_interactive_feedback({
  project_directory: "e:\\AgentRules\\English\\rules-2.1-optimized",
  summary: "Programa de feedback de desktop MCP iniciado. Por favor, preencha seus coment√°rios ou fa√ßa upload de capturas de tela na janela. Ap√≥s o envio, continuarei a iterar com base no feedback.",
  timeout: 3600
})
```

#### Momento de Disparo
- Usu√°rio insere comando `/feedback`
- Usu√°rio diz comandos em linguagem natural como "chamar programa de feedback", "abrir interface de feedback"
- Quando os requisitos n√£o est√£o claros
- Antes de decis√µes t√©cnicas importantes
- Ap√≥s a conclus√£o do design da solu√ß√£o
- Ap√≥s a conclus√£o da implementa√ß√£o do c√≥digo
- Ao encontrar erros que requerem orienta√ß√£o do usu√°rio

#### Mecanismo de Feedback Cont√≠nuo
Ap√≥s receber o feedback do usu√°rio, se o conte√∫do do feedback n√£o for "encerrar" ou "end", a ferramenta deve ser chamada novamente para continuar coletando feedback at√© que o usu√°rio indique explicitamente o fim.

#### Solu√ß√£o de Problemas
Se a janela da √°rea de trabalho n√£o aparecer:
1. Confirme se a ferramenta MCP est√° instalada corretamente
2. Verifique as configura√ß√µes de permiss√£o do sistema
3. Tente reduzir o valor de timeout para teste
4. Confirme se o nome da ferramenta est√° escrito corretamente

## üéØ Cen√°rios de Feedback Especializados

### üèóÔ∏è Confirma√ß√£o de Design de Arquitetura
```markdown
## Confirma√ß√£o de Solu√ß√£o de Arquitetura do Sistema

### Solu√ß√£o Atual
- **Padr√£o de Arquitetura**: Arquitetura de Microsservi√ßos
- **Stack Tecnol√≥gica**: Spring Boot + Docker + Kubernetes
- **Banco de Dados**: PostgreSQL + Redis
- **Fila de Mensagens**: RabbitMQ

### Pontos a Confirmar
1. **Granularidade da Divis√£o de Servi√ßos** - √â razo√°vel?
2. **Consist√™ncia de Dados** - Como lidar com transa√ß√µes distribu√≠das?
3. **Comunica√ß√£o de Servi√ßos** - Escolha entre REST vs gRPC?
4. **Estrat√©gia de Monitoramento** - Solu√ß√£o de coleta de logs e m√©tricas?

### Por favor, forne√ßa feedback
- Tamanho da equipe e n√≠vel t√©cnico
- Volume de concorr√™ncia e dados esperado
- Capacidade de opera√ß√µes e infraestrutura
- Cronograma e marcos do projeto
```

### ‚ö° Confirma√ß√£o de Design de API
```markdown
## Design de Interface da API Conclu√≠do

### Vis√£o Geral da Interface
- **Gerenciamento de Usu√°rio**: 15 interfaces
- **Autentica√ß√£o e Autoriza√ß√£o**: 8 interfaces  
- **Opera√ß√£o de Dados**: 23 interfaces
- **Processamento de Arquivos**: 6 interfaces

### Caracter√≠sticas do Design
- Estilo RESTful, formato de resposta unificado
- Autentica√ß√£o JWT + Controle de permiss√£o RBAC
- Limita√ß√£o de taxa de requisi√ß√£o e valida√ß√£o de par√¢metros
- Mecanismo completo de tratamento de erros

### Precisa Confirmar
1. **Granularidade da Interface** - Atende aos requisitos de neg√≥cios?
2. **Design de Permiss√£o** - A divis√£o de fun√ß√µes e permiss√µes √© razo√°vel?
3. **Considera√ß√µes de Desempenho** - Precisa de cache e otimiza√ß√£o?
4. **Gerenciamento de Vers√£o** - A estrat√©gia de vers√£o da API √© adequada?
```

### üóÑÔ∏è Confirma√ß√£o de Design de Banco de Dados
```markdown
## Design de Estrutura de Tabela de Banco de Dados

### Design de Tabela Principal
- **users**: Informa√ß√µes b√°sicas do usu√°rio (12 campos)
- **roles**: Gerenciamento de permiss√£o de fun√ß√£o (8 campos)
- **products**: Informa√ß√µes do produto (15 campos)
- **orders**: Dados do pedido (18 campos)

### Design de Relacionamento
- Usu√°rio-Fun√ß√£o: Relacionamento muitos-para-muitos
- Produto-Categoria: Relacionamento um-para-muitos
- Pedido-Produto: Relacionamento muitos-para-muitos

### Estrat√©gia de √çndice
- √çndice de chave prim√°ria: Todas as tabelas
- √çndice √∫nico: email, phone
- √çndice composto: (user_id, created_at)
- √çndice de texto completo: product_name, description

### Precisa Confirmar
1. **Tipo de Dados** - A escolha do tipo de campo √© adequada?
2. **Design de √çndice** - O desempenho da consulta atende aos requisitos?
3. **Escalabilidade** - O crescimento futuro dos dados foi considerado?
4. **Estrat√©gia de Backup** - Solu√ß√£o de backup e recupera√ß√£o de dados?
```

## üîß Configura√ß√£o

### Vari√°veis de Ambiente
```bash
# Configura√ß√£o de timeout de feedback (segundos)
FEEDBACK_TIMEOUT=3600

# N√≠vel de log
FEEDBACK_LOG_LEVEL=info

# Caminho de armazenamento
FEEDBACK_STORAGE_PATH=./feedback-logs

# Intervalo de salvamento autom√°tico (segundos)
FEEDBACK_AUTOSAVE_INTERVAL=300

# N√∫mero m√°ximo de hist√≥rico
FEEDBACK_MAX_HISTORY=100
```

### Configura√ß√µes Avan√ßadas
```json
{
  "feedback": {
    "timeout": 3600,
    "autoSave": true,
    "saveInterval": 300,
    "maxHistory": 100,
    "enableRichText": true,
    "enableScreenshots": true,
    "enableMermaid": true,
    "logLevel": "info"
  }
}
```

## üìä An√°lise de Feedback

### Rastreamento de M√©tricas
```javascript
// Estat√≠sticas de sess√£o de feedback
{
  "sessionId": "fb-2025-01-31-001",
  "startTime": "2025-01-31T10:00:00Z",
  "endTime": "2025-01-31T10:45:00Z",
  "duration": 2700, // 45 minutos
  "messageCount": 15,
  "decisionPoints": 3,
  "issuesResolved": 2,
  "userSatisfaction": 4.5
}
```

### M√©tricas de Qualidade
- **Tempo de Resposta** - Tempo m√©dio de resposta da IA
- **Taxa de Resolu√ß√£o** - Taxa de sucesso na resolu√ß√£o de problemas
- **Satisfa√ß√£o do Usu√°rio** - Pontua√ß√£o de qualidade do feedback
- **Taxa de Conclus√£o de Sess√£o** - Propor√ß√£o de sess√µes completadas

## üõ†Ô∏è Exemplos de Integra√ß√£o

### Integra√ß√£o Frontend
```javascript
// Usando feedback em componente Vue.js
export default {
  methods: {
    async requestFeedback(context) {
      const feedback = await this.$mcp.feedback({
        type: 'architecture-review',
        context: context,
        timeout: 3600000 // 1 hora
      });
      
      return feedback;
    }
  }
}
```

### Integra√ß√£o Backend
```python
# Usando mecanismo de feedback em Python
from mcp_feedback import FeedbackClient

async def design_review(design_doc):
    client = FeedbackClient(timeout=3600)
    
    feedback = await client.request_feedback(
        type="database-design",
        content=design_doc,
        questions=[
            "O design da estrutura da tabela √© razo√°vel?",
            "A estrat√©gia de √≠ndice est√° otimizada?",
            "Como a escalabilidade √© garantida?"
        ]
    )
    
    return feedback
```

## ‚úÖ Melhores Pr√°ticas

### Para Assistentes de IA (For AI Assistants)
- **Disparo Oportuno** - Solicitar feedback proativamente em pontos de decis√£o chave
- **Descri√ß√£o Clara** - Explicar detalhadamente o estado atual e o conte√∫do que precisa de confirma√ß√£o
- **Sa√≠da Estruturada** - Usar formato e marca√ß√£o claros
- **Manter Registros** - Salvar registros de decis√µes e feedbacks importantes

### Para Usu√°rios (For Users)
- **Feedback Detalhado** - Fornecer informa√ß√µes de feedback espec√≠ficas e detalhadas
- **Resposta Oportuna** - Responder a tempo antes do timeout
- **Decis√£o Clara** - Expressar claramente decis√µes e prefer√™ncias
- **Registrar Motivos** - Explicar as raz√µes e considera√ß√µes das decis√µes

### Para Equipes (For Teams)
- **Padr√£o Unificado** - Estabelecer padr√µes e processos de feedback da equipe
- **Compartilhamento de Conhecimento** - Compartilhar experi√™ncias de feedback e melhores pr√°ticas
- **Melhoria Cont√≠nua** - Revisar e otimizar regularmente o mecanismo de feedback
- **Integra√ß√£o de Ferramentas** - Integrar com ferramentas e processos existentes

## üìã Solu√ß√£o de Problemas (Troubleshooting)

### Problemas Comuns

#### Problema de Timeout
```
Problema: Sess√£o de feedback expirou
Causa: Instabilidade da rede ou alta carga do servidor
Solu√ß√£o: Verificar conex√£o de rede, iniciar feedback novamente
```

#### Falha ao Salvar
```
Problema: Falha ao salvar conte√∫do do feedback
Causa: Espa√ßo de armazenamento insuficiente ou problema de permiss√£o
Solu√ß√£o: Verificar espa√ßo em disco e permiss√µes de arquivo
```

#### Erro de Formato
```
Problema: Exibi√ß√£o anormal de formato rich text
Causa: Erro de an√°lise de Markdown
Solu√ß√£o: Verificar sintaxe Markdown, usar formato padr√£o
```

#### Falha na Chamada da Ferramenta
```
Problema: Falha na chamada da ferramenta MCP
Causa: Nome da ferramenta incorreto ou par√¢metro ausente
Solu√ß√£o: Confirmar o uso do nome correto da ferramenta mcp_mcp-feedback-enhanced_interactive_feedback
```
